2020-03-13 19:32:37,405 WARNING Process rank: -1, device: cuda, n_gpu: 4, distributed training: False, 16-bits training: False
2020-03-13 19:33:08,636 INFO Training/evaluation parameters Namespace(adam_epsilon=1e-08, albert_add=-1, albert_set=-1, bert_dup=-1, bert_dup_n=7, cache_dir='', config_name='', data_dir=None, device=device(type='cuda'), do_eval=True, do_lower_case=True, do_train=True, doc_stride=128, eval_all_checkpoints=False, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, lang_id=0, learning_rate=3e-05, local_rank=-1, logging_steps=500, max_answer_length=30, max_grad_norm=1.0, max_query_length=64, max_seq_length=384, max_steps=-1, model_name='robertasept_', model_name_or_path='roberta-base', model_type='rfqa', n_best_size=5, n_gpu=4, no_cuda=False, null_score_diff_threshold=0.0, num_train_epochs=3.0, output_dir='save/robertasept', overwrite_cache=False, overwrite_output_dir=False, per_gpu_eval_batch_size=8, per_gpu_train_batch_size=6, predict_file='data/dev-v2.0.json', project_dir='logs/', save_steps=8000, seed=42, server_ip='', server_port='', threads=32, tokenizer_name='', train_file='data/train-v2.0.json', verbose_logging=False, version_2_with_negative=True, warmup_steps=0, weight_decay=0.0)
2020-03-13 19:33:08,639 INFO Loading features from cached file ./cached_train_roberta-base_384
2020-03-13 19:34:24,486 INFO NUMBER PARAMS: 174262274
2020-03-13 19:34:24,494 INFO ***** Running training *****
2020-03-13 19:34:24,494 INFO   Num examples = 135860
2020-03-13 19:34:24,495 INFO   Num Epochs = 3
2020-03-13 19:34:24,495 INFO   Instantaneous batch size per GPU = 6
2020-03-13 19:34:24,495 INFO   Total train batch size (w. parallel, distributed & accumulation) = 24
2020-03-13 19:34:24,495 INFO   Gradient Accumulation steps = 1
2020-03-13 19:34:24,495 INFO   Total optimization steps = 16983
2020-03-14 01:09:10,184 INFO Saving model checkpoint to save/robertasept/robertasept_checkpoint-8000
2020-03-14 01:09:11,264 INFO Saving optimizer and scheduler states to save/robertasept/robertasept_checkpoint-8000
2020-03-14 06:43:50,093 INFO Saving model checkpoint to save/robertasept/robertasept_checkpoint-16000
2020-03-14 06:43:51,179 INFO Saving optimizer and scheduler states to save/robertasept/robertasept_checkpoint-16000
2020-03-14 07:25:00,781 INFO Saving model checkpoint to save/robertasept/robertasept_checkpoint-16984
2020-03-14 07:25:01,863 INFO Saving optimizer and scheduler states to save/robertasept/robertasept_checkpoint-16984
2020-03-14 07:25:01,867 INFO  global_step = 16984, average loss = 0.9632684439543531
2020-03-14 07:25:01,867 INFO Saving model checkpoint to save/robertasept
2020-03-14 07:25:08,461 INFO Loading checkpoints saved during training for evaluation
2020-03-14 07:25:08,462 INFO Evaluate the following checkpoints: ['save/robertasept']
2020-03-14 07:25:14,568 INFO Loading features from cached file ./cached_dev_roberta-base_384
2020-03-14 07:25:25,809 INFO ***** Running evaluation  *****
2020-03-14 07:25:25,810 INFO   Num examples = 6731
2020-03-14 07:25:25,811 INFO   Batch size = 32
2020-03-14 07:29:18,147 INFO   Evaluation done in total 232.336475 secs (0.034517 sec per example)
2020-03-14 07:29:27,053 INFO Results: {'f1': 83.39518218958142, 'HasAns_f1': 84.21852829837655, 'exact': 80.1085883514314, 'NoAns_total': 3168, 'best_exact': 80.1085883514314, 'HasAns_exact': 77.35395189003437, 'NoAns_f1': 82.63888888888889, 'HasAns_total': 2910, 'best_exact_thresh': 0.0, 'total': 6078, 'best_f1_thresh': 0.0, 'NoAns_exact': 82.63888888888889, 'best_f1': 83.39518218958155}
